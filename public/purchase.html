<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Achat billet ‚Äì AFARIS</title>
  <link rel="stylesheet" href="/styles.css" />
  <link rel="icon" href="/assets/logo_afaris.png" type="image/png" />
  <!-- Privacy-friendly analytics by Plausible -->
  <script async src="https://plausible.io/js/pa-AUNIvzG_5CUrpkovSU-75.js"></script>
  <script>
    window.plausible=window.plausible||function(){(plausible.q=plausible.q||[]).push(arguments)},plausible.init=plausible.init||function(i){plausible.o=i||{}};
    plausible.init();
  </script>

  <!-- Styles sp√©cifiques -->
  <style>
    .purchase-wrap{padding:3rem 3rem 4rem}
    .page-title{font-size:2.2rem;margin-bottom:1.8rem}
    .grid{display:grid;grid-template-columns:1.1fr .9fr;gap:2rem}
    .card{background:#161722;border-radius:1rem;padding:1.4rem 1.6rem;box-shadow:0 8px 24px rgba(0,0,0,.25)}
    .card h3{margin-bottom:1rem}
    .form-row{display:flex;gap:1rem}
    .form-group{flex:1;display:flex;flex-direction:column;margin-bottom:1rem}
    .form-group label{font-size:.95rem;margin-bottom:.35rem;color:#bdbdbd}
    .input{background:#0f101b;border:1px solid #26283a;border-radius:.6rem;padding:.75rem 1rem;color:#fff;outline:none;transition:border .15s, box-shadow .15s}
    .input:focus{border-color:#ff2674; box-shadow:0 0 0 3px rgba(255,38,116,.15)}
    .input.err{border-color:#ff4d6d}
    .hint{font-size:.85rem;color:#98a0b3;margin-top:.35rem}
    .error{font-size:.85rem;color:#ff879b;margin-top:.35rem;display:none}
    .error.show{display:block}
    .btn-row{display:flex;gap:.8rem;flex-wrap:wrap;margin-top:.6rem}
    .btn.full{width:100%;justify-content:center}
    .btn[disabled]{opacity:.55;cursor:not-allowed}
    .quantity-block{display:flex;flex-direction:column;gap:14px;margin:10px 0 18px}
    .quantity-row{display:flex;justify-content:space-between;align-items:center;gap:18px}
    .quantity-row .title{font-weight:600;color:#e2e8f0}
    .quantity-row .subtitle{color:#98a0b3;font-size:.85rem;margin-top:4px}
    .qty-control{display:flex;align-items:center;gap:10px;background:#0f101b;border:1px solid #2a2f45;border-radius:999px;padding:6px}
    .qty-btn{width:34px;height:34px;border-radius:50%;border:0;background:#1f2235;color:#fff;font-size:18px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s}
    .qty-btn:hover{background:#ff2674}
    .qty-btn:disabled{opacity:.45;cursor:not-allowed}
    .qty-value{width:52px;text-align:center;border:0;background:transparent;color:#fff;font-size:1rem;font-weight:600}
    .summary ul{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:.55rem}
    .summary li{display:flex;justify-content:space-between;gap:1rem;color:#ddd}
    .summary .total{margin-top:.7rem;border-top:1px solid #2a2c3e;padding-top:.7rem;font-weight:700}
    .badge-note{display:inline-block;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.09);padding:.35rem .6rem;border-radius:.5rem;color:#bdbdbd;font-size:.85rem}
    @media (max-width:980px){.grid{grid-template-columns:1fr}.purchase-wrap{padding:2rem 1.25rem}}

    @media (max-width:640px){
      header.navbar{flex-direction:column;gap:0.8rem;padding:1.2rem 1rem;align-items:flex-start}
      header.navbar nav{display:flex;flex-wrap:wrap;gap:0.6rem;width:100%}
      header.navbar nav a{margin:0;padding:0.45rem 0.85rem;border-radius:999px;background:rgba(16,17,28,0.4)}
      .purchase-wrap{padding:2rem 1rem}
      .page-title{font-size:1.8rem;text-align:center}
      .card{padding:1.1rem 1.2rem}
      .form-row{flex-direction:column}
      .quantity-row{flex-direction:column;align-items:flex-start;gap:10px}
      .qty-control{width:100%;justify-content:space-between}
      .btn-row{flex-direction:column}
      .btn-row .btn{width:100%;justify-content:center}
      .summary{margin-top:1.6rem}
      .paypal-slot{min-height:140px}
    }

    /* Toast (succ√®s/erreur l√©ger) */
    .toast{position:fixed;right:20px;bottom:20px;min-width:260px;max-width:360px;background:#0f101b;border:1px solid #283048;color:#fff;border-radius:.8rem;padding:.9rem 1rem;box-shadow:0 10px 26px rgba(0,0,0,.35);opacity:0;transform:translateY(8px);pointer-events:none;transition:opacity .2s, transform .2s;z-index:9999}
    .toast.show{opacity:1;transform:translateY(0)}
    .toast.success{border-color:#2d6a4f}
    .toast.error{border-color:#8a1c2b}
    .toast h4{margin:0 0 .25rem 0;font-size:1rem}
    .toast p{margin:0;color:#c9d0de;font-size:.92rem}

    .paypal-slot{margin-top:1.2rem;border:1px dashed #2a2f45;border-radius:.8rem;padding:1rem;min-height:120px;display:flex;align-items:center;justify-content:center;background:#0f101b}
    .status-box{margin-top:1rem;padding:.9rem 1rem;border-radius:.7rem;background:#10111c;border:1px solid #25273a;color:#c9d0de;font-size:.9rem;line-height:1.5}
    .status-box.error{border-color:#8a1c2b;color:#ff879b;background:#1b1013}
    .status-box.success{border-color:#2d6a4f;color:#9ae6b4;background:#101c16}
    .success-banner{display:none;margin:2rem auto 0;padding:1.2rem 1.4rem;border-radius:1rem;border:1px solid rgba(45,106,79,.8);background:linear-gradient(120deg,rgba(34,197,94,.15),rgba(15,16,27,.95));color:#e2f9eb;box-shadow:0 10px 30px rgba(0,0,0,.35);max-width:760px;gap:.8rem;align-items:center;animation:successSlide .6s ease forwards}
    .success-banner strong{font-size:1.05rem;display:block}
    .success-banner span{color:#c0f0d6;font-size:.9rem}
    .success-banner.show{display:flex}
    @keyframes successSlide{0%{opacity:0;transform:translateY(10px)}100%{opacity:1;transform:translateY(0)}}
  </style>
</head>

<body>
  <!-- Header identique √† l‚Äôaccueil -->
  <header class="navbar">
    <div class="logo">
      <img src="/assets/logo_afaris.png" alt="AFARIS" />
      <span>AFARIS</span>
    </div>
    <nav>
      <a href="/#tickets">Billets</a>
      <a href="/#infos">Infos</a>
      <a href="/admin/login">Scanner</a>
      <a id="adminLink" class="btn small ghost" href="/admin/login">Connexion</a>
      <div id="google_translate_element" aria-label="S√©lecteur de langue"></div>
    </nav>
  </header>

  <main class="purchase-wrap">
    <h1 class="page-title">Acheter un billet</h1>

    <div class="grid">
      <!-- Colonne gauche : formulaire -->
      <section class="card" aria-labelledby="infos-title">
        <h3 id="infos-title">Vos informations</h3>

        <div class="form-row">
          <div class="form-group">
            <label for="name">Nom et pr√©nom</label>
            <input id="name" class="input" type="text" placeholder="Votre nom complet" autocomplete="name" />
            <div id="err-name" class="error">Veuillez renseigner votre nom et pr√©nom.</div>
          </div>
          <div class="form-group">
            <label for="email">E-mail</label>
            <input id="email" class="input" type="email" placeholder="vous@email.com" autocomplete="email" />
            <div id="err-email" class="error">Adresse e-mail invalide.</div>
          </div>
        </div>

        <div class="form-group">
          <label>Quantit√© par type</label>
          <div class="quantity-block" aria-live="polite">
            <div class="quantity-row">
              <div>
                <div class="title">Entr√©e Standard ‚Äî 30‚Ç¨</div>
                <div class="subtitle">Acc√®s √† la soir√©e ‚Ä¢ Billet nominatif</div>
              </div>
              <div class="qty-control" data-type="standard">
                <button class="qty-btn" type="button" data-qty-btn data-type="standard" data-dir="-1" aria-label="Diminuer les billets standard">‚àí</button>
                <input id="qtyStandard" class="qty-value" type="number" value="1" min="0" readonly aria-live="off" aria-label="Quantit√© billets standard" />
                <button class="qty-btn" type="button" data-qty-btn data-type="standard" data-dir="1" aria-label="Augmenter les billets standard">+</button>
              </div>
            </div>
            <div class="quantity-row">
              <div>
                <div class="title">Entr√©e VIP ‚Äî 45‚Ç¨</div>
                <div class="subtitle">Table r√©serv√©e ‚Ä¢ Plat compris ‚Ä¢ Service personnalis√©</div>
              </div>
              <div class="qty-control" data-type="vip">
                <button class="qty-btn" type="button" data-qty-btn data-type="vip" data-dir="-1" aria-label="Diminuer les billets VIP">‚àí</button>
                <input id="qtyVip" class="qty-value" type="number" value="0" min="0" readonly aria-live="off" aria-label="Quantit√© billets VIP" />
                <button class="qty-btn" type="button" data-qty-btn data-type="vip" data-dir="1" aria-label="Augmenter les billets VIP">+</button>
              </div>
            </div>
          </div>
          <p class="hint">Ajoutez plusieurs billets si n√©cessaire, chaque ticket sera envoy√© s√©par√©ment par e-mail.</p>
        </div>

        <div class="badge-note" aria-live="polite">Paiement s√©curis√© via PayPal (compte ou carte bancaire).</div>
        <div id="paypal-buttons" class="paypal-slot" aria-busy="true" aria-live="polite"></div>
        <div id="status" class="status-box">Remplissez vos informations puis finalisez votre achat.</div>
      </section>

      <!-- Colonne droite : r√©capitulatif -->
      <aside class="card summary" aria-labelledby="recap-title">
        <h3 id="recap-title">R√©capitulatif</h3>
        <ul>
          <li><span>√âv√©nement</span><span>Soir√©e AFARIS ‚Äì Arido</span></li>
          <li><span>Date</span><span>27/12/2025</span></li>
          <li><span>Heure</span><span>19:00 ‚Ä¢ Show 20:00</span></li>
          <li><span>Lieu</span><span>Quai de l'Industrie 121<br/>1080 Molenbeek-Saint-Jean</span></li>
          <li id="recapStandard"><span>Standard</span><span id="recapStandardValue">1 √ó 30,00 ‚Ç¨</span></li>
          <li id="recapVip"><span>VIP</span><span id="recapVipValue">0 √ó 45,00 ‚Ç¨</span></li>
          <li class="total"><span>Total</span><span id="sumTotal">30,00 ‚Ç¨</span></li>
        </ul>
        <p class="hint" style="margin-top:.8rem">Chaque billet est nominatif : vous recevrez un e-mail distinct par ticket avec son QR code.</p>
      </aside>
    </div>
  </main>

  <div id="successBanner" class="success-banner" role="status" aria-live="polite">
    <div>
      <strong>Paiement r√©ussi ‚Äî votre billet est en route üéüÔ∏è</strong>
      <span>Pensez √† v√©rifier vos dossiers Spam / Courrier ind√©sirable si l‚Äôe-mail AFARIS n‚Äôappara√Æt pas sous 2 minutes.</span>
    </div>
  </div>

  <footer>
    <div class="wrap foot">
      <span>¬© 2025 AFARIS ‚Äì Une g√©n√©ration qui construit</span>
      <div class="contact-whatsapp">
        <span>Contact WhatsApp :</span>
        <a href="https://wa.me/32493925577" target="_blank" rel="noopener noreferrer" aria-label="WhatsApp AFARIS">+32&nbsp;493&nbsp;92&nbsp;55&nbsp;77</a>
      </div>
      <div class="social-links" aria-label="R√©seaux sociaux AFARIS">
        <a href="https://www.facebook.com/profile.php?id=61582489296334" target="_blank" rel="noopener noreferrer" aria-label="Facebook AFARIS">
          <span class="sr-only">Facebook</span>
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.99 3.66 9.12 8.44 9.88v-6.99H7.9v-2.89h2.54V9.41c0-2.5 1.49-3.89 3.77-3.89 1.09 0 2.23.2 2.23.2v2.46H15.2c-1.24 0-1.63.77-1.63 1.56v1.87h2.78l-.44 2.89h-2.34v6.99C18.34 21.12 22 16.99 22 12z"></path>
          </svg>
        </a>
        <a href="https://www.instagram.com/afaris.90/" target="_blank" rel="noopener noreferrer" aria-label="Instagram AFARIS">
          <span class="sr-only">Instagram</span>
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M7 2C4.24 2 2 4.24 2 7v10c0 2.76 2.24 5 5 5h10c2.76 0 5-2.24 5-5V7c0-2.76-2.24-5-5-5H7zm10.5 2c1.38 0 2.5 1.12 2.5 2.5V18.5c0 1.38-1.12 2.5-2.5 2.5H6.5C5.12 21 4 19.88 4 18.5V6.5C4 5.12 5.12 4 6.5 4H17.5zm-5.5 3.5A4.5 4.5 0 1 0 12 19.5 4.5 4.5 0 0 0 12 7.5zm0 2A2.5 2.5 0 1 1 12 14.5 2.5 2.5 0 0 1 12 9.5zm5.25-3.75a1.25 1.25 0 1 0 1.25 1.25 1.25 1.25 0 0 0-1.25-1.25z"></path>
          </svg>
        </a>
        <a href="https://www.tiktok.com/@afarisbx" target="_blank" rel="noopener noreferrer" aria-label="TikTok AFARIS">
          <span class="sr-only">TikTok</span>
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M21 8.56a5.24 5.24 0 0 1-4.04-1.99v6.18c0 4.13-3.35 7.48-7.48 7.48A7.48 7.48 0 0 1 2 12.75 7.5 7.5 0 0 1 7.25 6.5v3.2a3.32 3.32 0 0 0-2 3.03 3.33 3.33 0 0 0 3.33 3.33c1.84 0 3.33-1.49 3.33-3.33V2h3.44a5.25 5.25 0 0 0 4.72 4.87z"></path>
          </svg>
        </a>
      </div>
    </div>
  </footer>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite">
    <h4 id="toast-title"></h4>
    <p id="toast-msg"></p>
  </div>

  <!-- Script Connexion ‚Üî D√©connexion -->
  <script>
    (function(){
      const link=document.getElementById('adminLink');
      fetch('/admin/api/me',{credentials:'include'})
        .then(r=>r.ok?r.json():null).then(d=>{
          if(!d) return;
          if(d.ok||d.user||d.authenticated){link.textContent='D√©connexion (Admin)';link.href='/admin/logout';}
        }).catch(()=>{});
    })();
  </script>

  <!-- Logique de la page -->
  <script>
    const ticketPrices = { standard: 30, vip: 45 };

    const toast = (title, msg, type = 'success') => {
      const t = document.getElementById('toast');
      document.getElementById('toast-title').textContent = title;
      document.getElementById('toast-msg').textContent = msg;
      t.className = 'toast ' + type;
      t.classList.add('show');
      setTimeout(() => t.classList.remove('show'), 3500);
    };

    const nameEl = document.getElementById('name');
    const emailEl = document.getElementById('email');
    const errName = document.getElementById('err-name');
    const errEmail = document.getElementById('err-email');
    const statusBox = document.getElementById('status');
    const paypalContainer = document.getElementById('paypal-buttons');
    const successBanner = document.getElementById('successBanner');
    const sumTotalEl = document.getElementById('sumTotal');
    const qtyInputs = {
      standard: document.getElementById('qtyStandard'),
      vip: document.getElementById('qtyVip'),
    };
    const summaryValues = {
      standard: document.getElementById('recapStandardValue'),
      vip: document.getElementById('recapVipValue'),
    };
    const qtyButtons = document.querySelectorAll('[data-qty-btn]');

    const qty = { standard: 1, vip: 0 };

    const formatCurrency = (value) => new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR' }).format(value);

    function setStatus(message, state = 'info') {
      if (!statusBox) return;
      statusBox.textContent = message;
      statusBox.className = 'status-box';
      statusBox.dataset.state = state;
      if (state === 'error') statusBox.classList.add('error');
      if (state === 'success') statusBox.classList.add('success');
    }

    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    const validateField = (el, errEl, testFn) => {
      const ok = testFn(el.value.trim());
      el.classList.toggle('err', !ok);
      errEl.classList.toggle('show', !ok);
      return ok;
    };
    const validateName = () => validateField(nameEl, errName, (v) => v.length >= 2);
    const validateEmail = () => validateField(emailEl, errEmail, (v) => emailRegex.test(v));

    nameEl.addEventListener('input', validateName);
    emailEl.addEventListener('input', validateEmail);

    const totalTickets = () => qty.standard + qty.vip;
    const totalAmount = () => qty.standard * ticketPrices.standard + qty.vip * ticketPrices.vip;

    function updateQuantities() {
      qtyInputs.standard.value = qty.standard;
      qtyInputs.vip.value = qty.vip;

      summaryValues.standard.textContent = qty.standard
        ? `${qty.standard} √ó ${formatCurrency(ticketPrices.standard)}`
        : '0 billet';
      summaryValues.vip.textContent = qty.vip
        ? `${qty.vip} √ó ${formatCurrency(ticketPrices.vip)}`
        : '0 billet';

      sumTotalEl.textContent = formatCurrency(totalAmount());

      qtyButtons.forEach((btn) => {
        const type = btn.dataset.type;
        const dir = Number(btn.dataset.dir) || 0;
        if (!type || !Number.isFinite(dir)) return;
        if (dir < 0) {
          btn.disabled = qty[type] === 0;
        } else {
          btn.disabled = false;
        }
      });

      if (totalTickets() === 0 && statusBox?.dataset.state !== 'success') {
        setStatus('S√©lectionnez au moins un billet avant le paiement.', 'error');
      } else if (
        totalTickets() > 0 &&
        statusBox?.dataset.state === 'error' &&
        statusBox.textContent.includes('S√©lectionnez au moins un billet')
      ) {
        setStatus('Remplissez vos informations puis finalisez votre achat.');
      }
    }

    qtyButtons.forEach((btn) => {
      btn.addEventListener('click', () => {
        const type = btn.dataset.type;
        const dir = Number(btn.dataset.dir) || 0;
        if (!type || !Number.isFinite(dir)) return;
        if (dir < 0 && qty[type] === 0) return;
        qty[type] = Math.max(0, qty[type] + dir);
        updateQuantities();
      });
    });

    const preset = (new URLSearchParams(location.search).get('type') || '').toLowerCase();
    if (preset === 'vip') {
      qty.standard = 0;
      qty.vip = 1;
    }

    setStatus('Remplissez vos informations puis finalisez votre achat.');
    updateQuantities();

    const canSubmit = () => {
      const okName = validateName();
      const okEmail = validateEmail();
      const hasTickets = totalTickets() > 0;
      if (!hasTickets) {
        setStatus('S√©lectionnez au moins un billet avant le paiement.', 'error');
      }
      return okName && okEmail && hasTickets;
    };

    const formPayload = () => ({
      name: nameEl.value.trim(),
      email: emailEl.value.trim(),
      tickets: { ...qty },
    });

    async function createPaypalOrder() {
      if (!canSubmit()) {
        toast('Champs requis', 'Compl√©tez vos informations et choisissez au moins un billet.', 'error');
        throw new Error('FORM_INVALID');
      }
      const payload = formPayload();
      setStatus('Connexion √† PayPal‚Ä¶', 'info');

      const res = await fetch('/api/paypal/create-order', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      });
      if (!res.ok) {
        const text = await res.text();
        setStatus('PayPal est momentan√©ment indisponible. R√©essayez dans un instant.', 'error');
        toast('PayPal indisponible', text || 'Le service PayPal est momentan√©ment indisponible.', 'error');
        throw new Error(text || 'PAYPAL_CREATE_FAILED');
      }
      const data = await res.json();
      return data.id;
    }

    async function capturePaypalOrder(orderId) {
      const res = await fetch('/api/paypal/capture-order', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ orderId }),
      });
      if (!res.ok) {
        const text = await res.text();
        setStatus('La confirmation PayPal a √©chou√©. V√©rifiez votre paiement.', 'error');
        toast('Confirmation PayPal', text || 'La capture du paiement a √©chou√©.', 'error');
        throw new Error(text || 'PAYPAL_CAPTURE_FAILED');
      }
      return res.json();
    }

    function renderPaypalButtons() {
      if (!window.paypal) {
        setStatus('Impossible de charger PayPal. Actualisez la page.', 'error');
        toast('Erreur PayPal', 'Le SDK PayPal n‚Äôa pas pu √™tre charg√©.', 'error');
        return;
      }
      window.paypal.Buttons({
        style: { shape: 'pill', color: 'gold', layout: 'vertical', label: 'pay' },
        createOrder: () => createPaypalOrder(),
        onApprove: async (data) => {
          try {
            setStatus('Validation de votre paiement‚Ä¶', 'info');
            const result = await capturePaypalOrder(data.orderID);
            const ticketIds = Array.isArray(result?.ticketIds)
              ? result.ticketIds
              : result?.ticketIds
              ? [result.ticketIds]
              : [];
            const ticketsCount = ticketIds.length;
            const idsMsg = ticketsCount ? `Billet${ticketsCount > 1 ? 's' : ''} : ${ticketIds.join(', ')}.` : '';
            const emailsSent = Number(result?.emailsSent ?? (result?.emailSent ? ticketsCount : 0));
            const emailMsg = emailsSent
              ? `${emailsSent} e-mail${emailsSent > 1 ? 's' : ''} envoy√©${emailsSent > 1 ? 's' : ''}.`
              : result?.emailSent
              ? 'E-mails envoy√©s.'
              : 'Envoi e-mail indisponible, contactez-nous si besoin.';

            const statusMessage = `Merci ! ${ticketsCount} billet${ticketsCount > 1 ? 's' : ''} pr√™t${ticketsCount > 1 ? 's' : ''}. ${idsMsg} ${emailMsg}`.trim();
            setStatus(statusMessage, 'success');
            toast('Paiement confirm√©', emailMsg, 'success');
            showSuccessBanner();
            setTimeout(() => {
              window.location.href = '/';
            }, 4200);
          } catch (err) {
            console.error(err);
          }
        },
        onCancel: () => {
          setStatus('Paiement annul√©. Vous pouvez reprendre √† tout moment.', 'info');
        },
        onError: (err) => {
          console.error(err);
          setStatus('Une erreur PayPal est survenue. Merci de r√©essayer.', 'error');
          toast('Erreur PayPal', 'Merci de r√©essayer dans un instant.', 'error');
        },
      }).render('#paypal-buttons');
      paypalContainer?.setAttribute('aria-busy', 'false');
    }

    async function boot() {
      try {
        const res = await fetch('/api/config');
        if (!res.ok) throw new Error('CONFIG');
        const config = await res.json();
        if (!config.paypalClientId) {
          setStatus('Configuration PayPal manquante c√¥t√© serveur.', 'error');
          toast('Configuration PayPal', 'Client ID PayPal absent.', 'error');
          return;
        }
        const script = document.createElement('script');
        script.src = `https://www.paypal.com/sdk/js?client-id=${encodeURIComponent(
          config.paypalClientId
        )}&currency=EUR&intent=capture&enable-funding=card`;
        script.async = true;
        script.onload = renderPaypalButtons;
        script.onerror = () => {
          setStatus('Le SDK PayPal n‚Äôa pas pu √™tre charg√©.', 'error');
          toast('Erreur PayPal', 'Impossible de charger le SDK.', 'error');
        };
        document.head.appendChild(script);
      } catch (err) {
        console.error(err);
        setStatus('Impossible de joindre le serveur. V√©rifiez qu‚Äôil est d√©marr√©.', 'error');
        toast('Serveur indisponible', 'Impossible de r√©cup√©rer la configuration.', 'error');
      }
    }

    boot();
  </script>

  <!-- Google Translate -->
  <script>
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
        pageLanguage: 'fr',
        includedLanguages: 'fr,en,nl,ar,so,aa',
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
        autoDisplay: false
      }, 'google_translate_element');
    }
  </script>
  <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</body>
</html>
    function showSuccessBanner() {
      if (successBanner) {
        successBanner.classList.add('show');
      }
    }
